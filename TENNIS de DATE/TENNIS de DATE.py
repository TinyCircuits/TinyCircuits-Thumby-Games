import time 
import thumbyButton as Btn
import thumbyGraphics as Grf
import thumbySprite as Spr 
import random
import thumbySaves as SAVE 


# BITMAP: width: 45, height: 40
bm_ayane0 = bytearray([255,255,255,255,255,255,255, 31,111, 23, 19,235, 43,211,229, 21,229,241, 21,229,237, 13,221, 27, 83, 71,159, 31, 63,127,255,255,255, 63,223,239,239,239,239,223, 63,255,255,255,255,
255,255,255,255,255,255,255,255,255,248,247,  0,253,206,193,253,252,253,204,193,251,122,133,248,  1,197, 62,236,184,100,220,191, 96, 31,127,255,255,255,255,127,159,224,255,255,255,
255,255,255,255,255,255,255,255,255,255,255,255,120, 53,203,235,243,243,251,251, 57,192,159,127,  0,251,244,224,131,110,144,187,124,126, 62,189,129,129, 61,254,255,255,255,255,255,
255,255, 15,247,243,251,251,151,103,183,187,220,203,231,238,237,229,243,241,224,236,207, 29,187,167,159,191,191, 95,110,181, 81,195,163, 83,176,119,247,247,248,255,255,255,255,255,
255,255,255,254,254,254,254,254,255,255,255,255,255,255,255,255,255,255,255, 63,207,241, 14,240,254,254,  0,254,255,254,249,199, 62,249,247,238,221,186,117,109,171,215,239,255,255
])
bm_mask0 = bytearray([  0,  0,  0,  0,  0,224,248,252,252,254,254,254,255,255,255,255,255,255,255,255,255,255,255,255,254,254,252,248,240,240,224,224,240,240,248,248,248,248,248,248,240,224,192,  0,  0,
  0,  0,  0,  0,  0,  1,  1, 15, 31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 31,  0,
  0,  0,  0,  0,  0,  0,  0,  0,  0,129,199,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,239,231,231,255,255,255,255,255,227,131,  0,  0,  0,
240,252,254,254,254,254,254,254,254,255,255,255,255,127,127, 63, 63, 63, 63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,223,159, 31, 15,  0,  0,  0,
  0,  1,  3,  3,  3,  3,  3,  3,  3,  1,  1,  0,  0,  0,  0,  0,  0,192,248,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,124, 56
  ])

# BITMAP: width: 47, height: 40
bm_ayane1 =bytearray([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 31,159, 71, 83, 27,221, 13,237,229, 21,241,229, 21,229,211, 43,235, 19, 23,111, 31,255,255,255,255,255,255,255,255,255,
255,255,255,255,255,255,255,255,255,255,255,255,127,191,220,100,184,236, 62,197,  1,248,133,122,251,193,204,253,252,253,193,206,253,  0,247, 24,231,251,253,253,253,253,251,231, 31,255,255,
255,255,255,255,255,255,255,255,255,255,255,255,124,187,144,110,131,224,244,251,  0,127,159,192, 57,251,251,243,243,235,203, 53,120,255,255,252,243,207,191, 63, 63,191,207,243,252,255,255,
255,255,255,255,255,255,255,255,127,191, 95,160,199, 83,181,110, 95,191,191,159,167,187, 29,207,236,224,241,243,229,237,238,231,203,220,187,183,103,151,251,248,240,247, 15,255,255,255,255,
255,255,239,215,171,109,117,186,221,238,247,249, 62,199,249,254,255,254,  0,254,254,240, 14,241,207, 63,255,255,255,255,255,255,255,255,255,255,255,254,254,254,254,254,255,255,255,255,255
])
bm_mask1 = bytearray([  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,192,224,240,240,248,252,254,254,255,255,255,255,255,255,255,255,255,255,255,255,254,254,254,252,252,248,224,  0,  0,  0,  0,  0,  0,  0,
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,224,240,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,252,248,224,
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,199,231,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127,127, 31,  3,
  0,  0,  0,  0,  0,128,192,224,240,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 63, 63, 63, 63,127,127,255,255,255,255,255,255,255,255,255,255,251,248,240,  0,  0,
 56,124,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,248,192,  0,  0,  0,  0,  0,  0,  1,  1,  3,  3,  3,  3,  3,  3,  3,  1,  0,  0,  0
])

# BITMAP: width: 57, height: 40
bm_ayane2 =bytearray([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 63,223, 47, 39,215, 87,167,203, 43,203,227, 43,203,219, 27,187, 55,167,143, 63, 63,127,127,255,255,255,255,231,219,219,231,255,255,255,255,255,255,255,255,255,
255,255,255,255,255,255,255,255,255,255,255,255,255, 63,223,223, 63,254,254,240, 12,  3,246, 53,  3,244,243,247, 52,  3,247,244, 11,240,  2, 50,205,184,112,168,108, 94,223,191,127,255,255,255,255,255,255,255,255,255,255,255,255,
255,199, 51,125,253,253,253,253,249,251,243,231,143, 63,254,254,255,255,255,224,159,124,129, 99, 39, 73,225,  1,227,199, 35,112, 71,159,124, 97, 24,241, 39, 28,129, 55,  0,125,126,188,193,219,219,153, 90,102,126,126,189,195,255,
255,255,255,254,254,253,249,251,251,251,251,251,249,240,227,199, 15,223,239,239,239,239,208, 59,155,199,206,208,205,221,157, 56,113,117,125,124,127,127,191,220,106,165,139, 71, 95, 95,191,191,127,127,255,255,255,255,255,255,255,
255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,249,251,251,251,251,253,254,255,255,255,255,255,255,255,255,  0,253,253,225, 29,253,248,230,222, 61,251,247,239,223,190,126,253,251,122,182,197,249,255,255,255
])
bm_mask2 = bytearray([   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192,240,248,248,252,252,252,254,254,254,254,254,254,254,254,254,254,254,254,252,252,248,240,224,224,192,128,128, 60,126,126,126,126, 60,  0,  0,  0,  0,  0,  0,  0,  0,
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,224,240,240,243,243,239,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,240,240,224,128,  0,  0,128,128,128,128,128,128,  0,  0,
124,254,255,255,255,255,255,255,255,255,254,254,253,251,243,195,  3,  1, 63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,126,
  0,  1,  3,  7,  7, 15, 15, 15, 15, 15, 15, 15, 63, 63,255,255,252,248,248,248,253,255,255,255,255,255,255,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,253,249,240,224,193,193,129,129,  1,  1,  0,  0,
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3, 15, 15, 15, 31, 31, 31, 31, 15, 15,  7,  1,  0,  0,  0,  0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 15,  0,  0
])

# BITMAP: width: 55, height: 40
bm_ayane3 =bytearray([255,255,255,255,255,255,255,231,219,219,231,255,255,255,255,127,127, 63, 63,143,167, 55,187, 27,219,203, 43,227,203, 43,203,167, 87,215, 39, 47,223, 63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
255,255,255,255,255,255,255,255,255,255,127,191,223, 94,108,168,112,184,205, 50,  2,240, 11,244,247,  3, 52,247,243,244,  3, 53,246,  3,236,240,254,254, 63,223,223, 63,255,255,255,255,255,255,255,255,255,255,255,255,255,
255,255,255,255,255,255,255,255,127,191,220,221, 88,151,129, 92,  7,193,  0, 97,124,159, 71,240,243,231,227, 65, 17,113,247,251,253,254,255,255,255,255,255,254,254, 63,143,231,243,251,249,253,253,253,253,125, 51,199,255,
255,255,255,255,255,127,127,191,188, 91, 87, 87,132,165,106,220,191,127,127, 63, 79,118,120, 49,131,197,206,223,211,205,156, 57,215,239,239,239,239,223, 15,199,227,240,249,251,251,251,251,251,249,253,254,254,255,255,255,
255,249,197,182,122,251,253,126,190,223,239,247,251, 61,222,230,248,253, 29,225,253,253,  0,255,255,255,255,255,255,255,255,254,253,251,251,251,251,249,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
])
bm_mask3 = bytearray([  0,  0,  0,  0,  0,  0, 60,126,126,126,126, 60,128,128,192,224,224,240,248,252,252,254,254,254,254,254,254,254,254,254,254,254,254,252,252,252,248,248,240,192,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
  0,  0,  0,  0,  0,  0,  0,  0,  0,224,240,240,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255, 63,239,243,243,240,240,224,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
  0,  0,  0,  0,  0,  0,192,224,240,247,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,223,159, 15,  7,  3,  0,  1,  3,195,243,251,253,254,254,255,255,255,255,255,255,255,255,254,124,
  0,  0,128,128,192,192,231,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127,127,255,255,255,255,255,254,252,248,248,248,252,255,255, 63, 63, 15, 15, 15, 15, 15, 15, 15,  7,  7,  3,  1,  0,
 15,127,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,  0,  0,  0,  0,  1,  7, 15, 15, 31, 31, 31, 31, 15, 15, 15,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0
])

# BITMAP: width: 42, height: 40
bm_ayaneUP =bytearray([255, 63,159,175,207, 23,215, 23,215, 71,151,219, 91,189,221, 93,181,217, 89,189, 61,189,189,125,251,251,247,239,159,127,127,255,255,255,255,255,255,255,255,255,255,255,
255,255,255,255,248,247,232,  7, 39,208,131, 39,248,231,216,198,241,171,208,139,211, 36,211,174, 25,181, 69,169,170,212,  0,  0,  7, 31,127,255,255,255,255,255,255,255,
255,255,255,255,255,  7,192, 56,255,255,248,248,111,127,127,127,127,127,255,240,240,240,248, 63,192,255,  0, 62,158,  1, 62,109,251,183,119,111,239,223,191,127,255,255,
255,255,255,255,240,207,191,  1,132,121,  3,231, 71, 78, 13,141,205, 14,135, 39,227,243,248,240,207, 63,252,  0,  0,193,  3, 14, 92,177,  3,230,216,129,251,230,129,255,
255,255,255,255,255,255,255,255, 30,227, 61,198,217,158,127,127,  7,176,223,111,119, 59,187,189,190,190,156,232,119,153,238,247,247,250,253,243,207, 63,255,255,255,255
])
bm_ayaneUPM= bytearray([224,240,248,252,252,252,252,252,252,254,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,254,252,248,240,192,192,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,
  1,  1, 15, 31,191,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252,240,192,  0,  0,  0,  0,  0,  0,
  0,  0,224,252,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,253,253,248,248,240,224,192,  0,
  0,  0, 31, 63,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
  0,  0,  0,  0,  0,  0,225,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,248,224,  0,  0,  0
])


# BITMAP: width: 35, height: 40
bm_BG =bytearray([ 95,191, 95,191, 95, 63, 87,191, 95, 63, 85,191, 85,191, 85, 42, 85,171, 21, 34,  5,  2,  9,  4, 10,192,227,255,255,252,227,143, 31,127, 95,
252,252,248,240,224,200,156,  0,248, 84,  0,  0,120, 56,  1,144,209,192,224,240,240,248,248,254,255,255,255,255,255,255,255,255,255,255,254,
234, 82,170, 82,170, 82,255,  0,255, 85,  0,  2,249,172, 87,171, 82,250,210,250,242,250,250,250,250,250,250,122,186,122,186, 90,250, 90,250,
 26, 29, 10, 13, 10, 61, 31, 32, 63, 85, 64, 32, 31,122,255,255,255,255,255,255,255,255,255, 63, 63, 31, 63, 29, 30, 23, 58,125,255,119,255,
  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  3,  3,  7, 15, 15, 15,  7,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0])

# BITMAP: width: 60, height: 19
bm_Racket =bytearray([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127, 63, 31,159,143,207,231,  7,231,227,227,227,  3,225,233,233,233,  1,233,233,233,233,  1,233,233,233,225,  3,227,227,227,231,  7,231,207,143,159, 31, 63,127,255,255,255,255,
255,255,255,127,127, 63, 63, 31, 31, 31,143,135,195,  3,  1,192,232,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,232,192,  3, 31,255,
224,224,224,192,192,142,142, 14, 31, 31, 63, 63,127,  0,  0,110,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,238,238,  0,238,238,110,  0,  0,255])

bm_Racket_M =bytearray([  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,192,224,240,240,120,120, 60, 28,252, 30, 30, 30, 30,255, 31, 23, 23, 23,255, 23, 23, 23, 23,255, 23, 23, 23, 31,255, 30, 30, 30, 30,252, 28, 60,120,120,240,240,224,192,128,  0,  0,
128,128,192,192,224,224,240,240,240,248,252,254,254,255,255, 63, 23, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 23, 63,255,254,240,
 31, 31, 31, 63, 63,119,119,247,231,231,199,199,135,255,255,145, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17, 17, 17,255, 17, 17,145,255,255,  7])


# BITMAP: width: 72, height: 40
bm_TITLE =bytearray([255,255,255, 15,243,253,158,146,146,146,146,146, 18, 18,146,146,158,158,253,253,229,229,229,229,229,229,229,229,253,253,254,242,242,242,242,242,242,114,  2,  2,254,253,243,215, 23,215,215,183,119,247, 55,215,215,215,215, 55,239,223, 31, 63,127,255,255,143, 55,119,247, 79, 15,247,119, 47,
255,255,255,255,240,239, 95, 83,211,147,147,145,152,156,143,143,135,207,159,153,153,153,153,153,153,153, 25, 25,217,255, 63, 51, 51, 51, 49, 57, 56,252, 24, 17,243, 31, 31,247,240,247,247,247,248,255,248,246,246,246,246, 58, 47,231,224,  0, 16, 63,115,237,221,220,230,193,187,188,177,195,
255,255,255,231,219,219,230,254,255,255, 15,215,235,115,187,219,215, 15,127,255,255,255,255,255,255,255,240, 15,255,249, 57, 57, 57, 57, 25,129,193,249,121, 57, 57, 63, 63, 63, 51, 51, 51, 51, 51, 51, 51, 51, 63,255,255,  0,  0,249,249, 19, 19, 19,159,158,129,129,195,255,255,249,249,255,
255,255,255,255,255,239, 15, 15,239,255, 15, 14,173,236,249,  9,  8,184,120, 12,255, 15, 15,191,127, 15,255, 15, 14,253,157,141,169, 41, 41,249,249,248, 56,184, 12,254, 15,175,143,255,255,255, 15, 15,239,223, 62,253, 29,169,169,  9, 25,248,232,  8, 15,239,255, 15, 15,175,239,255,255,255,
255,135,131,235,235,135,254,214,255,255,178,170,138,254,251,130,250,255,135,234,235,134,254,131,235,234,151,254,250,131,250,254,190,222,238,247,251,255,130,130,170,171,150,254,214,255,255,255,194,190,190,194,254,179,170,139,255,134,234,235,135,254,198,187,171,138,254,130,170,171,187,255])
# BITMAP: width: 72, height: 40
bm_USAGE =bytearray([255,195,245,245,193,195,255,193,193,255,193,243,231,243,193,193,255,255,255,255,193,193,221,219,199,255,193,193,255,193,193,245,229,211,255,193,193,213,221,255,195,193,221,221,255,253,193,193,253,255,193,193,255,193,193,221,193,255,193,195,247,239,193,255,255,255,255,255,255,255,255,255,
255,193,193,207,207,255,193,193, 85,221,255, 65,193,245,253,255,253,193,193,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,216,216,194,226,255,251,251,255,224,239,239,255,224,234,238,255,248,231,248,255,224,234,238,255,224,239,239,255,237,234,230,255,
255,255,255,255,255,255,255,255,128,255,255, 15,246,149,151,247, 15,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127,191,191,191,191,127,255,255,255,255,255,255, 31,239,247, 55, 55,247,239, 31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
255,255,255,255,255,255,240,222,210,210,222, 30,255,255,255,255, 30,222,210,210,222,225,191,127,255,255,255,255,255,255,255,255,127,191,240,239,223,217,217,223,239,240,255,255,255,255,255,254,253,251,251,251,251,253,118,111,223,255,127,255,255,127,127,255,255,127,127,127,127,255,255,255,
255,255,255,255,255,255,255,255,255,255,255,252,251,251,251,251,252,255,255,255,131,131,235,203,166,255,131,131,255,131,131,186,139,255,131,131,239,239,131,255,251,131,131,251,255,255,255,255,255,255,255,255,255,255,240,240,253,253,240,255,255,240,240,255,255,255,240,240,255,255,255,255])


# BITMAP: width: 16, height: 15
bm_MISS_M= bytearray([ 255,  1,  1,  1,  1,  7, 31,127,127, 31,  7,  1,  1,  1,  1,255,
255,192,192,192,192,254,248,240,240,248,254,192,192,192,192,255])

# BITMAP: width: 6, height: 15
bm_MISS_I= bytearray([255,  1,  1,  1,  1,255,255,192,192,192,192,255])

# BITMAP: width: 15, height: 15
bm_MISS_S= bytearray([255,135,  3,  1,  1, 17, 17, 49, 49, 49, 97, 97, 97,227,255,
255,227,195,195,195,198,198,196,196,196,192,192,224,240,255])

# BITMAP: width: 5, height: 8
bm_SNum0 = bytearray([  1,  1, 61,  1,  1])
bm_SNum1 = bytearray([255,253,  1,  1,255])
bm_SNum2 = bytearray([ 57, 25, 13, 33, 49])
bm_SNum3 = bytearray([ 53, 53, 53,  1,  1])
bm_SNum4 = bytearray([225,225,239,  1,  1])
bm_SNum5 = bytearray([ 49, 49, 53,  5, 13])
bm_SNum6 = bytearray([  3,  1, 53,  5,  5])
bm_SNum7 = bytearray([249,249,249,  1,  1])
bm_SNum8 = bytearray([  1,  1, 37,  1,  1])
bm_SNum9 = bytearray([ 35, 33, 45,  1,129])


tbl_Num=[bm_SNum0,bm_SNum1,bm_SNum2,bm_SNum3,bm_SNum4,bm_SNum5,bm_SNum6,bm_SNum7,bm_SNum8,bm_SNum9]

# BITMAP: width: 38, height: 19
bm_DownFlame = bytearray([  1,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,  1,
  0, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63,  0,
255,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,252,255])

# BITMAP: width: 5, height: 8
bm_DirCur_L= bytearray([147, 57,124,254,  0])
bm_DirCur_R= bytearray([  0,254,124, 57,147])

# BITMAP: width: 31, height: 10
bm_TXT_RALLY= bytearray([  3,  3, 51, 35,  7,143,255, 15,  7, 35, 51,  3,  3,255,  3,  3,255,255,255,255,  3,  3,255,255,255,195,131,159,159,  3,  3,
252,252,255,254,252,252,255,252,252,255,255,252,252,255,252,252,252,252,252,255,252,252,252,252,252,255,252,252,252,252,254])
# BITMAP: width: 35, height: 8
bm_TXT_RECORD= bytearray([255,129,129,237,237,147,255,129,129,181,189,255,195,129,189,189,255,195,129,189,189,195,255,129,129,237,237,147,255,129,129,189,187,199,255])
# BITMAP: width: 20, height: 6
bm_TXT_NEW= bytearray([192,192,249,231,192,192,255,192,192,202,202,206,255,224,192,207,224,207,192,224])


############################################################################
# BITMAP: width: 7, height: 20
bm_BG_Pole_L = bytearray([  0,250,  0,253,  3,235, 11,  0,255,  0,255,  0,255,  0,112,151,224,244,242,244,246])

# BITMAP: width:12, height: 18
bm_BG_Net_L = bytearray([170,  2,170,  2,170,  2,170,  2,170,  2,170,  2,170,128,170,128,170,128,170,128,170,128,170,128,253,253,253,253,253,253,253,253,253,253,253,253])

# BITMAP: width: 4, height: 28
bm_BG_Net_C = bytearray([  2,250,250,  2,128,191,191,128,253,  0,  0,253,247,240,240,247])


# BITMAP: width: 11, height: 8
bm_miniGirl= bytearray([143,111, 31,127,113, 32,  0,  0, 32, 97,231])



# BITMAP: width: 4, height: 4
bm_Ball0 = bytearray([249,246,246,249])
#bm_Ball_M0 = bytearray([  6, 15, 15,  6])
# BITMAP: width: 5, height: 5
bm_Ball1 = bytearray([241,238,238,238,241])
#bm_Ball_M1 = bytearray([ 14, 31, 31, 31, 14])
# BITMAP: width: 6, height: 6
bm_Ball2 = bytearray([225,222,222,222,222,225])
bm_Ball_M2 = bytearray([ 30, 63, 63, 63, 63, 30])

# BITMAP: width: 8, height: 8
bm_Ball3 = bytearray([195,189,126,126,126,126,189,195])
bm_Ball_M3 = bytearray([ 60,126,255,255,255,255,126, 60])

# BITMAP: width: 10, height: 10
bm_Ball4 = bytearray([135,123,253,254,254,254,254,253,123,135,255,223,142,141,141,141,141,142,223,255])
bm_Ball_M4 = bytearray([120,252,254,255,255,255,255,254,252,120,  0, 32,113,115,115,115,115,113, 32,  0])
# BITMAP: width: 12, height: 12
bm_Ball5 = bytearray([ 15,243,253,253,254,254,254,254,253,253,243, 15,255,124, 59, 59, 55, 55, 55, 55, 59, 59,124,255])
#bm_Ball_M5 = bytearray([240,252,254,254,255,255,255,255,254,254,252,240,  0,131,199,199,207,207,207,207,199,199,131,  0])
# BITMAP: width: 14, height: 14
bm_Ball6 = bytearray([ 31,231,251,253,253,254,254,254,254,253,253,251,231, 31,254,249,247,239,239,223,223,223,223,239,239,247,249,254])
#bm_Ball_M6 = bytearray([224,248,252,254,254,255,255,255,255,254,254,252,248,224,  1,  7, 15, 31, 31, 63, 63, 63, 63, 31, 31, 15,  7,  1])

# BITMAP: width: 3, height: 1
bm_Shadow1 = bytearray([254,254,254])
# BITMAP: width: 4, height: 2
bm_Shadow2 = bytearray([252,252,252,252])
# BITMAP: width: 6, height: 2
bm_Shadow3 = bytearray([252,252,252,252,252])
# BITMAP: width: 8, height: 3
bm_Shadow4 = bytearray([253,248,248,248,248,248,248,253])
# BITMAP: width: 10, height: 4
bm_Shadow5 = bytearray([249,240,240,240,240,240,240,240,240,249])


# BGY_Tbl=Down*27,UP*13
BGY_Tbl=[-1,-2,-2,-1,0,1,2,4,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,
38,32,26,21,16,12,8,5,2,0,-1,-1,-1]
BallChr_Tbl=[0,0,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,
5,5,4,4,3,3,3,2,2,2,1,0,0]
Ball_Y_Tbl=[0,-1,-2,-3,-3,-2,-1,0,0,1,1,2,3,4,6,8,12,8,4,2,0,-2,-4,-5,-5,-6,-6,
-7,-8,-9,-10,-10,-10,-9,-8,-7,-6,-4,-3,-2]
ShadowChr_Tbl=[0,0,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,5,5,5,5,
5,5,4,4,3,3,3,2,2,2,1,0,0]
Shadow_Y_Tbl=[10,10,8,8,6,6,6,6,5,5,5,4,4,4,4,4,4,4,4,4,5,5,6,8,9,10,10,
8,6,5,4,4,4,5,5,6,8,8,10,10]
GirlUP_Tbl=[64,32,16,8,4,4,4,4,3,3,3,2,2,2,1,1,0,0,0,0,0]


MODE=0 
# MODE=0...TITLE
# MODE=1....FIELD SCEAN
# MODE=2.....GIRL'S SHOT
# MODE=3...MISS

SAVE.saveData.setName("TENNIS de DATE")

Record=1
if (SAVE.saveData.hasItem("Record")):
    Record= int(SAVE.saveData.getItem("Record"))




Girl_Dir=0 # Girl's Direction       
deftmp=0
while(1):###########################################################

    if(MODE==0):#### TITLE
        CNT=0
        FLG=0
        while(FLG==0):
            Grf.display.setFPS(20) # standardize display speed    
            Sprite_TITLE =Spr.Sprite(72, 40, bm_TITLE,0,0)
            Grf.display.drawSprite(Sprite_TITLE)
            if (CNT<10):
                Grf.display.drawFilledRectangle(0, 34, 70, 6, 1)# Blink
            CNT=CNT+1
            if(CNT>20):
                CNT=0
            if (Btn.buttonA.justPressed()):#### A Button in TLTLE
                FLG=1
                X=0
                BG_X=0
                BG_Y_ofset=20
                BG_Y=20
                T_CNT=27
                BG_CNT=0
                MGX=0# mini Girl X
                MyDir=0
                X_Add=0# Ball X +
                G_AIM=0 #Girls Hit Aim
                MY_AIM=0 #Players AIM
                Swing=4
                RacD=0 #Racket Direction
                MODE=1
                RALLY=0
                
            if (Btn.buttonB.pressed()):#### B Button in TLTLE 
                Sprite_USAGE = Spr.Sprite(72, 40, bm_USAGE,0,0)
                Grf.display.drawSprite(Sprite_USAGE)
                Grf.display.update()
                
            Grf.display.update()


    Grf.display.fill(1) # Fill canvas to white

# A Button ***************************************************** A Button 
    if (Btn.buttonA.justPressed()):

        if(BG_CNT>10)and(BG_CNT<29):
            Swing=7  # Start Swing
            if (BG_X > 0):
                RacD=1
            else:
                RacD=0           
# B Button ***************************************************** B Button 
    if (Btn.buttonB.justPressed()):

        if(BG_CNT<27):
            MyDir=MyDir+(MyDir<5)

# L Button***************************************************** Left Button 
    if (Btn.buttonL.justPressed()):
        
        if(BG_CNT<27):
            MyDir=MyDir-(MyDir>-5)

# R Button ***************************************************** Right Button 
    if (Btn.buttonR.justPressed()):

        if(BG_CNT<27):
            MyDir=MyDir+(MyDir<5)

# D Button ***************************************************** Down Button 
    #if (Btn.buttonD.pressed()):
        #BG_Y=BG_Y-(BG_Y > -50)

# U Button ***************************************************** UP Button 
    if (Btn.buttonU.justPressed()):
        
        if(BG_CNT<27):
            MyDir=MyDir-(MyDir>-5)

###############################################################################           
    if(MODE==1):            
    ## Draw BackGround **********************************************
        Grf.display.setFPS(14) # standardize display speed

        X=X-X_Add
        BG_X=int(X)
    
        BG_XD=BG_X+35
        BG_Y=BG_Y_ofset-BGY_Tbl[BG_CNT]
        Sprite_BG0 =Spr.Sprite(7, 20, bm_BG_Pole_L,BG_XD-55,BG_Y)
        Grf.display.drawSprite(Sprite_BG0)
        #Sprite_BG0 =Spr.Sprite(7, 20, bm_BG_Pole_R,BG_XD+50,BG_Y)
        #Grf.display.drawSprite(Sprite_BG0)
        Grf.display.blit(bm_BG_Pole_L,BG_XD+50,BG_Y, 7, 20, 1, 1, 0)
        
        Sprite_BG0 =Spr.Sprite(12, 18, bm_BG_Net_L ,BG_XD-48,BG_Y+2)
        Grf.display.drawSprite(Sprite_BG0)
        Sprite_BG0 =Spr.Sprite(12, 18, bm_BG_Net_L ,BG_XD-36,BG_Y+2)
        Grf.display.drawSprite(Sprite_BG0)
        Sprite_BG0 =Spr.Sprite(12, 18, bm_BG_Net_L ,BG_XD-24,BG_Y+2)
        Grf.display.drawSprite(Sprite_BG0)
        Sprite_BG0 =Spr.Sprite(12, 18, bm_BG_Net_L ,BG_XD-12,BG_Y+2)
        Grf.display.drawSprite(Sprite_BG0)
        
        Grf.display.blit( bm_BG_Net_L,BG_XD+2,BG_Y+2, 12, 18, 1, 1, 0)
        Grf.display.blit( bm_BG_Net_L,BG_XD+14,BG_Y+2, 12, 18, 1, 1, 0)
        Grf.display.blit( bm_BG_Net_L,BG_XD+26,BG_Y+2, 12, 18, 1, 1, 0)
        Grf.display.blit( bm_BG_Net_L,BG_XD+38,BG_Y+2, 12, 18, 1, 1, 0)

        Sprite_BG0 =Spr.Sprite(4, 28, bm_BG_Net_C ,BG_XD-1,BG_Y+2)        
        Grf.display.drawSprite(Sprite_BG0)

        Grf.display.drawLine(BG_XD-58, BG_Y+29, BG_XD+60, BG_Y+29, 0)
        Grf.display.drawLine(BG_XD-55, BG_Y+20, BG_XD-100, BG_Y+65, 0)    
        Grf.display.drawLine(BG_XD-52, BG_Y+20, BG_XD-81, BG_Y+65, 0)    
        Grf.display.drawLine(BG_XD+57, BG_Y+20, BG_XD+102, BG_Y+65, 0)    
        Grf.display.drawLine(BG_XD+53, BG_Y+20, BG_XD+84, BG_Y+65, 0)            
        
    # mini Girl Draw ######################################                


        if(BG_CNT<29):
            if(MGX>X):
                MGX=MGX-0.6
            if(MGX<X):
                MGX=MGX+0.6
        else:
            tmp=(50-RALLY)/200
            if (tmp<0):
                tmp=0
            if(MGX>MY_AIM):
                MGX=MGX-(0.3+tmp)
            if(MGX<MY_AIM):
                MGX=MGX+(0.3+tmp)
            
        if(MGX<-46):
            MGX=-46
        if(MGX>46):
            MGX=46
        
        Sprite_miniGirl =Spr.Sprite(11, 8, bm_miniGirl ,31+BG_X-int(MGX),BG_Y-6) 
        Grf.display.drawSprite(Sprite_miniGirl)    
 

    
        if(MGX<MY_AIM+1):
            Girl_Dir=0
        else:
            Girl_Dir=1
    
    # Ball Draw ######################################
    
        BallCHR=BallChr_Tbl[BG_CNT]
        deftmp=int((BallCHR+1)/2)
        deftmp_Y=Ball_Y_Tbl[BG_CNT]-2
        ShadowCHR=ShadowChr_Tbl[BG_CNT]
        defShadow_Y=Shadow_Y_Tbl[BG_CNT]+30
        
        
        if(BallCHR==0):
            Sprite_Ball =Spr.Sprite(4, 4, bm_Ball0 ,35-deftmp,17+deftmp_Y)  
            Grf.display.drawSprite(Sprite_Ball)
        elif(BallCHR==1):
            Sprite_Shadow =Spr.Sprite(3, 1, bm_Shadow1 ,37-deftmp,defShadow_Y)  
            Grf.display.drawSprite(Sprite_Shadow)
            Sprite_Ball =Spr.Sprite(5, 5, bm_Ball1 ,35-deftmp,17+deftmp_Y)  
            Grf.display.drawSprite(Sprite_Ball)        
        elif(BallCHR==2):
            Sprite_Shadow =Spr.Sprite(4, 2, bm_Shadow2 ,37-deftmp,defShadow_Y)  
            Grf.display.drawSprite(Sprite_Shadow)
            Grf.display.blitWithMask(bm_Ball2,35-deftmp,17+deftmp_Y, 6, 6, 0, 0, 0, bm_Ball_M2) 
        elif(BallCHR==3):
            Sprite_Shadow =Spr.Sprite(6, 2, bm_Shadow3 ,36-deftmp,defShadow_Y)  
            Grf.display.drawSprite(Sprite_Shadow)
            Grf.display.blitWithMask(bm_Ball3,35-deftmp,17+deftmp_Y, 8, 8, 0, 0, 0, bm_Ball_M3) 
            #no.3-Ball have a Mask
        elif(BallCHR==4):
            Sprite_Shadow =Spr.Sprite(8, 3, bm_Shadow4 ,36-deftmp,defShadow_Y)  
            Grf.display.drawSprite(Sprite_Shadow)
            Grf.display.blitWithMask(bm_Ball4,35-deftmp,17+deftmp_Y,10,10, 0, 0, 0, bm_Ball_M4) 
            #no.4-Ball have a Mask          
        elif(BallCHR==5):
            Sprite_Shadow =Spr.Sprite(10, 4, bm_Shadow5 ,36-deftmp,defShadow_Y)  
            Grf.display.drawSprite(Sprite_Shadow)
            Sprite_Ball =Spr.Sprite(12,12, bm_Ball5 ,35-deftmp,17+deftmp_Y)  
            Grf.display.drawSprite(Sprite_Ball)  
        elif(BallCHR==6):
            Sprite_Shadow =Spr.Sprite(10, 4, bm_Shadow5 ,36-deftmp,defShadow_Y)  
            Grf.display.drawSprite(Sprite_Shadow)
            Sprite_Ball =Spr.Sprite(14,14, bm_Ball6 ,35-deftmp,17+deftmp_Y)  
            Grf.display.drawSprite(Sprite_Ball)    

        T_CNT=T_CNT+1 ########################################### SPEED
        
        BG_CNT=int(T_CNT)
        if (BG_CNT>=len(BGY_Tbl)):
            BG_CNT=0
            T_CNT=0
            MODE=2 ######### Girl's SHOT
            
        if (MyDir!=0):
            if(MyDir<0):
                for i in range(-1,MyDir-1,-1):
                    Sprite_Dir =Spr.Sprite(5,8, bm_DirCur_L ,25+i*5,32)  
                    Grf.display.drawSprite(Sprite_Dir)                       
            else:
                for i in range(1,MyDir+1,1):
                    Sprite_Dir =Spr.Sprite(5,8, bm_DirCur_R ,42+i*5,32)  
                    Grf.display.drawSprite(Sprite_Dir)                     

        if(BG_CNT==27):
            if(Swing>0):
                X_Add=MyDir*(0.65)+(X/45)
                MY_AIM=int(X-X_Add*15) # Players AIM

            else:
                for i in range(0,10):
                    Grf.display.update()
                MODE=3 ### MISS

        if(Swing>0):
            if(Swing<6):
                Grf.display.blitWithMask(bm_Racket,0+RacD*12,0, 60, 19, 0,RacD, 0, bm_Racket_M) 
                Grf.display.blitWithMask(bm_Racket,0+RacD*12,18, 60, 19, 0,RacD, 1, bm_Racket_M)             
            Swing=Swing-1  
            
    ########################################### GIRL's HIT !!    
    elif(MODE==2):# Drow Girl's HIT#######################################################
        Grf.display.setFPS(42) # standardize display speed
        
        #GXtmp=abs(int(MGX- MY_AIM))
        GXtmp=abs(int(MGX- X))
        for i in range(0,20):
            ix=i  # int(i/3)
            Sprite_BG =Spr.Sprite(35, 40, bm_BG ,0,1)  
            Grf.display.drawSprite(Sprite_BG)       
            Sprite_BG =Spr.Sprite(35, 40, bm_BG ,35,0)  
            Grf.display.drawSprite(Sprite_BG)   


            if(Girl_Dir==1):
            # Draw girl ****************************************************
                if(GXtmp<8):# Right
                    Grf.display.blitWithMask(bm_ayane1, -20+ix,0, 47, 40, 0, 0, 0, bm_mask1)
                    Grf.display.blitWithMask(bm_Ball3, 44+GXtmp+int(X_Add*i/8),40-int(ix/1.2), 8, 8, 0, 0, 0, bm_Ball_M3)
                else:
                    Grf.display.blitWithMask(bm_ayane3, -20+ix,0, 55, 40, 0, 0, 0, bm_mask3)
                    Grf.display.blitWithMask(bm_Ball3, 44+GXtmp+int(X_Add*i/8),40-int(ix/1.2), 8, 8, 0, 0, 0, bm_Ball_M3)
            else:#  Left
                if(GXtmp<8):
                    Grf.display.blitWithMask(bm_ayane0, 44-ix,0, 45, 40, 0, 0, 0, bm_mask0)
                    Grf.display.blitWithMask(bm_Ball3, 18-GXtmp+int(X_Add*i/8),40-int(ix/1.2), 8, 8, 0, 0, 0, bm_Ball_M3)              
    
                else:
                    Grf.display.blitWithMask(bm_ayane2, 42-ix,0, 57, 40, 0, 0, 0, bm_mask2)
                    Grf.display.blitWithMask(bm_Ball3, 18-GXtmp+int(X_Add*i/8),40-int(ix/1.2), 8, 8, 0, 0, 0, bm_Ball_M3)              
            
            
            if(GXtmp<14)and(RALLY%10==9)and(RALLY>1):
                tmp=GirlUP_Tbl[i]

                if(Girl_Dir==1):
                    Grf.display.blitWithMask(bm_ayaneUP,0-tmp,0, 42, 40, 0, 1, 0, bm_ayaneUPM)
                else:
                    Grf.display.blitWithMask(bm_ayaneUP, 30+tmp,0, 42, 40, 0, 0, 0, bm_ayaneUPM)
                        
                    
            Grf.display.update()
                         
            
        if(GXtmp<14):   
            MODE=1
            MyDir=0
    
            tmp=RALLY+(RALLY%10==9)*RALLY*2
            tmp2=int(30+RALLY/2+(RALLY%4==3)*20)
            tmp=tmp+random.randint(0, tmp2)
            if(tmp>42):
                tmp=42 ###  Maximum amplitude
                
            tmp2=random.randint(0, 1)*2-1 # [+] or [-]
            G_AIM=tmp2*tmp
            if(G_AIM<-100):
                G_AIM=-100
            if(G_AIM>100):
                G_AIM=100
                
            X_Add= (BG_X-G_AIM)/27
            RALLY=RALLY+(RALLY<999)

        else:
            for i in range(0,10):
                Grf.display.update()
            MODE=3 ### MISS
        
    ###########################################   M I S S    
    elif(MODE==3):##  M I S S  ###################################

        Grf.display.setFPS(30) # standardize display speed
        Miss_Y=-15
        for MissCNT in range(0,40):
            Sprite_Miss =Spr.Sprite(16, 15, bm_MISS_M,7,int(Miss_Y))  
            Grf.display.drawSprite(Sprite_Miss)
            Sprite_Miss =Spr.Sprite(6, 15, bm_MISS_I,26,int(Miss_Y))  
            Grf.display.drawSprite(Sprite_Miss)
            Sprite_Miss =Spr.Sprite(15, 15, bm_MISS_S,35,int(Miss_Y))  
            Grf.display.drawSprite(Sprite_Miss)
            Sprite_Miss =Spr.Sprite(15, 15, bm_MISS_S,52,int(Miss_Y))  
            Grf.display.drawSprite(Sprite_Miss)
            
            if (MissCNT<18):
                Miss_Y=Miss_Y+1
            elif(MissCNT<22):
                Miss_Y=Miss_Y+.5
            elif(MissCNT<25):
                Miss_Y=Miss_Y+.25
                
            Grf.display.update()

        flg=0
        MissCNT=72
        RALLY_Y=-34 # TEXT 'RALLY' Y_Position

        while(flg==0):
            
            Grf.display.drawFilledRectangle(MissCNT+16, 0, 72, 40, 1) # ERASE
            
            Sprite_RALLY =Spr.Sprite(31, 10, bm_TXT_RALLY,40,int(RALLY_Y))  
            Grf.display.drawSprite(Sprite_RALLY)           
            RALLY_Y=RALLY_Y+(RALLY_Y<0)*.5
 
            Grf.display.blitWithMask(bm_ayaneUP, MissCNT,0, 42, 40, 0, 0, 0, bm_ayaneUPM)
            #Grf.display.update()  
            tmp=RALLY
            Rtmp=Record
            for i in range(1,4):### RALLY & Record
            
                tmp2=tmp % 10
                if not((tmp<10)and(tmp2==0)):# RALLY
                    Sprite_Number =Spr.Sprite(5,8,tbl_Num[tmp2] ,70-i*6,10-MissCNT)  
                    Grf.display.drawSprite(Sprite_Number)                  
                tmp=int(tmp/10)

                Rtmp2=Rtmp % 10
                if not((Rtmp<10)and(Rtmp2==0)):# RALLY
                    Sprite_Number =Spr.Sprite(5,8,tbl_Num[Rtmp2] ,70-i*6+MissCNT,31)  
                    Grf.display.drawSprite(Sprite_Number)                  
                Rtmp=int(Rtmp/10)   
            
            Grf.display.blitWithMask(bm_ayaneUP, MissCNT,0, 42, 40, 0, 0, 0, bm_ayaneUPM)
            
            Sprite_RECORD=Spr.Sprite(35, 8, bm_TXT_RECORD,38,24-int(RALLY_Y))  
            Grf.display.drawSprite(Sprite_RECORD)     
            
            Grf.display.update()           
            # A Button ***************************************************** A Button 
            if (Btn.buttonA.justPressed())and(MissCNT<1):
                flg=1
            
            MissCNT=MissCNT-1
            if(MissCNT<0):
                MissCNT=0
        
        if(RALLY>Record):#  New RECORD !
        
            Record=RALLY
            SAVE.saveData.setItem("Record", RALLY)
            SAVE.saveData.save()
            
            for j in range(0,38,2):
                Grf.display.fill(1) # Fill canvas to white
                
                tmp=RALLY
                for i in range(1,4):### RALLY (New RECORD)
                    tmp2=tmp % 10
                    if not((tmp<10)and(tmp2==0)):# RALLY
                        Sprite_Number =Spr.Sprite(5,8,tbl_Num[tmp2] ,40-j+24-i*6,10)  
                        Grf.display.drawSprite(Sprite_Number)                  
                    tmp=int(tmp/10)
                
                Sprite_RALLY =Spr.Sprite(31, 10, bm_TXT_RALLY,40-j,int(RALLY_Y))  
                Grf.display.drawSprite(Sprite_RALLY)     

                Grf.display.blitWithMask(bm_ayaneUP, j,0, 42, 40, 0, 0, 0, bm_ayaneUPM)        
                
                Grf.display.update()  
                
            CNT=0
            Flg=0
            while(flg<2):

                Sprite_RECORD=Spr.Sprite(20, 6, bm_TXT_NEW,9,23)  
                Grf.display.drawSprite(Sprite_RECORD)                        
                Sprite_RECORD=Spr.Sprite(35, 8, bm_TXT_RECORD,4,30)  
                Grf.display.drawSprite(Sprite_RECORD)                        
            
                if (CNT%20<10):
                    Grf.display.drawFilledRectangle(0, 20, 40, 40, 1)# Blink
                    
                # A Button ***************************************************** A Button                         
                if (CNT>100)and(Btn.buttonA.justPressed()):
                    flg=2
 


                CNT=CNT+(CNT<10000)
                Grf.display.update()          
        MODE=0


#Screen Update    
    Grf.display.update()


    
